---
apiVersion: cilium.io/v2alpha1
kind: CiliumL2AnnouncementPolicy
metadata:
  name: lan-announcement
  labels:
    app.kubernetes.io/name: cilium-l2policy
    app.kubernetes.io/instance: lan-announcement
    app.kubernetes.io/component: loadbalancer
    app.kubernetes.io/part-of: idp
  annotations:
    description: 'L2 announcement policy for LAN service exposure'
    contact: platform-team
    documentation: 'https://docs.cilium.io/en/stable/network/l2-announcements/'
spec:
  # Announce all LoadBalancer IPs from the pool
  loadBalancerIPs: true

  # Do not announce externalIPs (we only want LoadBalancer IPs)
  externalIPs: false

  # Node selector - announce from all nodes
  # This enables failover if a node goes down
  nodeSelector:
    matchLabels:
      kubernetes.io/os: linux

  # Interface selection - announce on all interfaces
  # Cilium will automatically detect the correct interface
  # For k3d, this will be the bridge interface to the host
  interfaces:
    - ^eth[0-9]+
