apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - appproject-cicd.yaml
  - appproject-events.yaml
  - appproject-observability.yaml
  - appproject-backstage.yaml
  - appproject-policies.yaml
  - appproject-security.yaml

patches:
  - target:
      kind: Service
      name: argocd-server
    patch: |-
      apiVersion: v1
      kind: Service
      metadata:
        name: argocd-server
      spec:
        ports:
          - name: http
            appProtocol: grpc
          - name: https
            appProtocol: grpc

commonAnnotations:
  contact: platform-team
  documentation: https://argo-cd.readthedocs.io/

labels:
  - includeSelectors: true
    pairs:
      app.kubernetes.io/part-of: idp
      owner: platform-team
      business-unit: infrastructure
      environment: demo
