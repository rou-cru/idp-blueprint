## @section External Secrets Operator Configuration
# -- Install CRDs. Should be true for the initial installation.
installCRDs: true
# -- Number of replicas for the operator.
replicas: 1
# -- Defines resource requests and limits for the operator pod.
resources:
  requests:
    cpu: 250m
    memory: 256Mi
  limits:
    cpu: 1000m
    memory: 1Gi
## @section Health Probes
## @description Configure liveness and readiness probes for External Secrets Operator.
livenessProbe:
  # -- Enabled determines if the liveness probe should be used or not. By default it's disabled.
  enabled: false
  # -- The body of the liveness probe settings.
  spec:
    # -- Address for liveness probe.
    address: ""
    # -- Specify the maximum amount of time to wait for a probe to respond before considering it fails.
    timeoutSeconds: 5
    # -- Number of consecutive probe failures that should occur before considering the probe as failed.
    failureThreshold: 5
    # -- Period in seconds for K8s to start performing probes.
    periodSeconds: 10
    # -- Number of successful probes to mark probe successful.
    successThreshold: 1
    # -- Delay in seconds for the container to start before performing the initial probe.
    initialDelaySeconds: 10
    # -- Handler for liveness probe.
    httpGet:
      # -- Set this value to 8082 to active liveness probes.
      # @schema type: [string, integer]
      port: 8082
      # -- Path for liveness probe.
      path: /healthz

readinessProbe:
  enabled: true
  spec:
    httpGet:
      port: 8081
      path: /readyz
    initialDelaySeconds: 20
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

# -- Increase concurrent ExternalSecret reconciliations for better performance
concurrent: 5

serviceAccount:
  create: true
  name: 'external-secrets'

## @section Webhook Configuration
## @description Configure External Secrets Operator webhook with cert-manager integration.
webhook:
  # -- Certificate validity lookahead interval for webhook
  # Must be less than cert.renewBefore to prevent crashloops
  lookaheadInterval: "168h"  # 7 days
  certManager:
    enabled: true
    # -- Automatically inject CA into webhooks and CRDs
    addInjectorAnnotations: true
    cert:
      create: true
      issuerRef:
        group: cert-manager.io
        kind: ClusterIssuer
        name: ca-issuer
      # -- Certificate lifetime: 90 days (2160h)
      duration: "2160h"
      # -- Renew 30 days before expiry (720h)
      # Must be greater than webhook.lookaheadInterval (168h)
      renewBefore: "720h"
      # -- Private key rotation policy (cert-manager >= 1.18.0 default: Always)
      privateKey:
        rotationPolicy: Always

## @section Prometheus Metrics
## @description Enable Prometheus ServiceMonitor for External Secrets Operator.
serviceMonitor:
  enabled: true
  interval: 60s
  scrapeTimeout: 40s
  honorLabels: true
