## @section External Secrets Operator Configuration

priorityClassName: platform-infrastructure

# -- Install CRDs. Should be true for the initial installation.
installCRDs: true
# -- Number of replicas for the operator.
replicas: 1
# -- Defines resource requests and limits for the operator pod.
resources:
  requests:
    cpu: 250m
    memory: 256Mi
  limits:
    cpu: 1000m
    memory: 1Gi
## @section Health Probes
## @description Configure liveness and readiness probes for External Secrets Operator.
livenessProbe:
  enabled: false

readinessProbe:
  enabled: true
  spec:
    httpGet:
      port: 8081
      path: /readyz
    initialDelaySeconds: 20
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

# -- Increase concurrent ExternalSecret reconciliations for better performance
concurrent: 5

serviceAccount:
  create: true
  name: 'external-secrets'

## @section Webhook Configuration
## @description Configure External Secrets Operator webhook with cert-manager integration.
webhook:
  # -- Certificate validity lookahead interval for webhook
  # Must be less than cert.renewBefore to prevent crashloops
  lookaheadInterval: "168h"  # 7 days
  certManager:
    enabled: true
    # -- Automatically inject CA into webhooks and CRDs
    addInjectorAnnotations: true
    cert:
      create: true
      issuerRef:
        group: cert-manager.io
        kind: ClusterIssuer
        name: ca-issuer
      # -- Certificate lifetime: 90 days (2160h)
      duration: "2160h"
      # -- Renew 30 days before expiry (720h)
      # Must be greater than webhook.lookaheadInterval (168h)
      renewBefore: "720h"
      # -- Private key rotation policy (cert-manager >= 1.18.0 default: Always)
      privateKey:
        rotationPolicy: Always

## @section Prometheus Metrics
## @description Enable Prometheus ServiceMonitor for External Secrets Operator.
serviceMonitor:
  enabled: true
  interval: 60s
  scrapeTimeout: 40s
  honorLabels: true
