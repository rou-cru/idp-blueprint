# @section -- General
# -- (string) Priority class for Trivy pods
priorityClassName: platform-security

# -- (string) Comma-separated list of target workloads
targetWorkloads: "pod,replicaset,replicationcontroller,statefulset,daemonset,cronjob,job"

# -- (string) Namespaces to be excluded from scanning
excludeNamespaces: "kube-system,argocd,cert-manager,vault-system,kyverno-system"

# @section -- Operator
operator:
  # -- (bool) Enable vulnerability scanner
  vulnerabilityScannerEnabled: true
  # -- (bool) Enable configuration audit scanner
  configAuditScannerEnabled: true
  # -- (bool) Enable RBAC assessment scanner
  rbacAssessmentScannerEnabled: true
  # -- (bool) Enable exposed secret scanner
  exposedSecretScannerEnabled: true
  # -- (bool) Disable infrastructure assessment scanner
  infraAssessmentScannerEnabled: false
  # -- (bool) Enable cluster compliance scanner
  clusterComplianceEnabled: true

  # @section -- Scan Job Concurrency & Performance
  # -- (int) Maximum number of concurrent scan jobs (default: 10)
  scanJobsConcurrentLimit: 3
  # -- (int) Maximum number of concurrent node collector jobs (default: 1)
  scanNodeCollectorLimit: 1
  # -- (string) Timeout for scan jobs
  scanJobTimeout: 5m
  # -- (string) Delay before retrying failed scan jobs
  scanJobsRetryDelay: 30s

# @section -- Compliance
compliance:
  # -- (bool) Enable compliance reporting
  enabled: true
  # -- (list) Compliance specifications to run
  specs:
    - "k8s-pss-baseline-0.1"

# @section -- Resources
resources:
  requests:
    # -- (string) CPU request
    cpu: 100m
    # -- (string) Memory request
    memory: 128Mi
  limits:
    # -- (string) CPU limit
    cpu: 500m
    # -- (string) Memory limit
    memory: 512Mi

# @section -- Scanner
trivy:
  # -- (string) Scanner mode
  mode: ClientServer
  # -- (string) Trivy Server URL
  serverURL: "http://trivy-server.security.svc:4954"
  # -- (bool) Use slower scanning mode (lower CPU/memory usage)
  slow: true

# @section -- Trivy Server
trivyServer:
  # -- (bool) Enable Trivy Server deployment
  enabled: true
  # -- (string) Database update interval
  dbUpdateInterval: 12h

  persistence:
    # -- (bool) Enable persistence
    enabled: true
    # -- (string) Storage class
    storageClass: "local-path"
    # -- (string) Storage size
    size: 1Gi

  resources:
    requests:
      # -- (string) CPU request
      cpu: 200m
      # -- (string) Memory request
      memory: 512Mi
    limits:
      # -- (string) CPU limit
      cpu: 1000m
      # -- (string) Memory limit
      memory: 1Gi

# @section -- Observability
serviceMonitor:
  # -- (bool) Enable ServiceMonitor
  enabled: true
  # -- (bool) Honor labels on collisions
  honorLabels: true
